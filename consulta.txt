select clave_empresa, nombre_empresa, clave_producto, nombre_producto, sum( peso_bruto ), sum( peso_tara ), sum( peso_neto ) from registros_internos join empresas on registros_internos.clave_empresa = empresas.clave_empresa join productos on registros_internos.clave_producto = productos.clave_producto where fecha = date( 'now', 'localtime' ) group by empresas;

select registros_internos.clave_empresa, nombre_empresa, productos.clave_producto, nombre_producto, sum( peso_bruto ), sum( peso_tara ), sum( descuento ), sum( peso_neto ) from registros_internos join empresas on registros_internos.clave_empresa = empresas.clave_empresa join productos on registros_internos.clave_producto = productos.clave_producto where tipo_registro = 0 and pendiente = 0 and fecha between '2020-11-03' and date( 'now', 'localtime' ) group by registros_internos.clave_empresa, registros_internos.clave_producto order by nombre_empresa;

select productos.clave_producto, nombre_producto, sum( case when tipo_registro = 0 then peso_neto else 0 end ) as entrada, sum( case when tipo_registro = 1 then peso_neto else 0 end ) as salida, ( sum( case when tipo_registro = 0 then peso_neto else 0 end ) - sum( case when tipo_registro = 1 then peso_neto else 0 end ) ) as total from registros_internos join productos on registros_internos.clave_producto = productos.clave_producto where tipo_registro = 0 and pendiente = 0 and fecha between '2020-11-03' and '2020-11-03' group by registros_internos.clave_producto order by nombre_producto;


select clave_empresa, nombre_empresa, clave_producto, nombre_producto, sum( peso_bruto ), sum( peso_tara ), sum( peso_neto ) from registros_internos join empresas on registros_internos.clave_empresa = empresas.clave_empresa join productos on registros_internos.clave_producto = productos.clave_producto where pendiente = 0 group by empresas;